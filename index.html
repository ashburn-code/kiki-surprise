<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Special Delivery for Kiki</title>
<style>
  /* Your existing styles here (omitted for brevity), plus: */

  .shake {
    animation: shake 0.6s ease-in-out;
  }

  @keyframes shake {
    0%, 100% { transform: translate(0, 0) rotate(0deg); }
    20% { transform: translate(-3px, 3px) rotate(-5deg); }
    40% { transform: translate(3px, -3px) rotate(5deg); }
    60% { transform: translate(-3px, 3px) rotate(-5deg); }
    80% { transform: translate(3px, -3px) rotate(5deg); }
  }
</style>
</head>
<body>

<!-- ...Your existing HTML structure -->

<div id="animation-wrapper">
  <div id="gift-animation" class="shake"></div>
  <div id="jiji-animation"></div>
</div>

<!-- ...rest of HTML -->

<script src="https://cdnjs.cloudflare.com/ajax/libs/lottie-web/5.9.6/lottie.min.js"></script>
<script>
  const giftContainer = document.getElementById('gift-animation');
  const jijiContainer = document.getElementById('jiji-animation');
  const message = document.getElementById('message');
  const clickHere = document.getElementById('click-here');
  const animationContainer = document.getElementById('animation-container');
  const meow = document.getElementById('meow-sound');

  let shakeInterval;

  // Shake start & stop functions
  function startShake() {
    // Add class only if gift visible
    if (giftContainer.style.display !== 'none') {
      giftContainer.classList.add('shake');
    }
  }

  function stopShake() {
    giftContainer.classList.remove('shake');
  }

  // Remove 'shake' class after animation ends to avoid it sticking around
  giftContainer.addEventListener('animationend', () => {
    stopShake();
  });

  // Loop shake every 3 seconds
  function scheduleShakeLoop() {
    clearInterval(shakeInterval);

    startShake();

    shakeInterval = setInterval(() => {
      // Only shake if gift still visible
      if (giftContainer.style.display !== 'none') {
        startShake();
      } else {
        clearInterval(shakeInterval);
      }
    }, 3000);
  }

  scheduleShakeLoop();

  // Load animations (paths your own)
  const giftAnimation = lottie.loadAnimation({
    container: giftContainer,
    renderer: 'svg',
    loop: false,
    autoplay: false,
    path: 'assets/gift.json'
  });

  const jijiAnimation = lottie.loadAnimation({
    container: jijiContainer,
    renderer: 'svg',
    loop: true,
    autoplay: false,
    path: 'assets/jiji.json'
  });

  jijiContainer.style.display = 'none';

  function openPresent() {
    clearInterval(shakeInterval);
    stopShake();

    message.classList.add('hidden');
    clickHere.style.display = 'none';

    giftAnimation.goToAndPlay(0, true);

    giftAnimation.addEventListener('complete', () => {
      giftContainer.style.display = 'none';
      jijiContainer.style.display = 'block';
      jijiAnimation.play();

      setTimeout(() => {
        meow.play().catch(() => {});
      }, 2000);

      message.textContent = "Surprise! Itâ€™s Jiji! ğŸ¾ğŸ’–";
      message.classList.remove('hidden');
    }, { once: true });
  }

  animationContainer.addEventListener('click', openPresent);
  clickHere.addEventListener('click', openPresent);
</script>
</body>
</html>
